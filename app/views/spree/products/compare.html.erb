<div class="title">
  <h1>Compare Products</h1>
  <a class="continue btn btn-default pull-right" href="/products">Continue shopping</a>
</div>
<% if @products.present? %>
    <table class="table">
      <thead>
      <tr class="active">
        <th colspan="4">Products</th>
      </tr>
      </thead>
      <tbody>
      <tr class="line-item">
        <% @products.each do |product| %>
            <td>
              <% url = spree.product_path(product, taxon_id: @taxon.try(:id)) %>
              <div id="product_<%= product.id %>" class=" product-list-item" data-hook="products_list_item" itemscope itemtype="https://schema.org/Product">
                <div class="panel panel-default">
                  <% cache(@taxon.present? ? [I18n.locale, current_currency, @taxon, product] : cache_key_for_product(product)) do %>
                      <div class="panel-body text-center product-body">
                        <%= link_to url, itemprop: "url" do %>
                            <%= small_image(product, itemprop: "image") %><br/>
                            <span itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                              <span class="price selling lead" itemprop="price"><%= display_price(product) %></span>
                            </span>
                        <% end %>
                        <br/>
                      </div>
                      <div class="panel-footer">
                        <%= link_to url, itemprop: "url" do %>
                            <%= content_tag(:span, truncate(product.name, length: 50), class: "info", itemprop: "name", title: product.name) %>
                        <% end %>
                      </div>
                      <div class="text-center clear-compare-single-item-btn">
                        <%= link_to "/compare/#{product.id}", method: :delete, class: 'btn btn-default' do %>
                          <span class="glyphicon glyphicon-remove"></span> Remove from Compare
                        <% end %>

                        <% if product.can_supply? %>
                            <div class="add-to-cart">
                              <br />
                              <div class="input-group">
                                <%= number_field_tag :quantity, 1, class: 'title form-control', min: 1 %>
                                <span class="input-group-btn">
                                <%= button_tag class: 'btn btn-success', id: 'add-to-cart-button', type: :submit do %>
                                  <span class="glyphicon glyphicon-shopping-cart"></span> <%= Spree.t(:add_to_cart) %>
                                <% end %>
                              </span>
                              </div>
                            </div>
                        <% end %>

                      </div>
                  <% end %>
                </div>
              </div>
            </td>
        <% end %>
      </tr>
      <% @properties.each do |prop| %>
          <thead>
          <tr class="active">
            <th colspan="4">
              <%= prop %>
            </th>
          </tr>
          </thead>
          <tbody>
            <tr class="line-item">
              <% @products.each do |product| %>
              <td>
                <%= product.product_properties.find {|pp| pp.property.presentation == prop }.try(:value) %>
              </td>
              <% end %>
            </tr>
          </tbody>
      <% end %>
      </tbody>
    </table>
<% else %>
    <h2>No products are in the compare list.</h2>
    <p>Please add items by clicking the "Add to Compare" button on a product.</p>
<% end %>
